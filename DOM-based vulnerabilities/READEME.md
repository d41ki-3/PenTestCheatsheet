# DOM Vulnerabilities  
[HackTricks-DOM](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/dom-xss)  
DOM vulnerabilities occur when data from attacker-controlled sources (like location.search, document.referrer, or document.cookie) is unsafely transferred to sinks. Sinks are functions or objects (e.g., eval(), document.body.innerHTML) that can execute or render harmful content if given malicious data.  

・**Sources** are inputs that can be manipulated by attackers, including URLs, cookies, and web messages.  

・**Sinks** are potentially dangerous endpoints where malicious data can lead to adverse effects, such as script execution.  

The risk arises when data flows from a source to a sink without proper validation or sanitation, enabling attacks like XSS.  

##  Common sources  
```
document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
```
